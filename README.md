Відкрити браузер
chromium --remote-debugging-port=9222

перейти
cd /form-filler

запустити
node run.js 4

Автоматизація створення документів з Google Forms

Цей проєкт Google Apps Script автоматизує створення документів Google Slides або Google Docs на основі даних, отриманих з Google Form. Він відстежує нові рядки у Google Sheet, копіює файл-шаблон, замінює в ньому плейсхолдери {{Назва Колонки}} на реальні дані та зберігає готовий файл у вказану папку на Google Drive.

Ключові можливості

    Автоматична обробка: Скрипт самостійно знаходить нові рядки в таблиці-джерелі.

    Підтримка шаблонів: Працює з шаблонами Google Slides та Google Docs.

    Динамічна заміна даних: Автоматично замінює плейсхолдери {{Назва Колонки}} на відповідні дані з рядка таблиці.

    Гнучке налаштування: Усі основні параметри винесені в єдиний конфігураційний файл _config.gs.

    Зручне встановлення: Інтерактивний майстер налаштування initialSetup() для легкого введення всіх необхідних ID.

    Вибір папки для збереження: Дозволяє вказати будь-яку папку на Google Drive для збереження згенерованих файлів.

Як це працює

Проєкт використовує архітектуру "продюсер-консюмер" для надійної та поетапної обробки даних.

    Продюсер (A_...): Скрипт знаходить нові рядки у вашій Google Таблиці і додає їх як завдання у спеціальну таблицю-чергу (Queue) зі статусом NEW.

    Консюмер №1 - Копіювальник (B_...): Скрипт знаходить завдання зі статусом NEW, створює копію вашого файлу-шаблону, називає її і змінює статус завдання на COPIED.

    Консюмер №2 - Заповнювач (C_...): Скрипт знаходить завдання зі статусом COPIED, відкриває створений файл, заповнює його даними з таблиці і змінює статус на FILLED.

Встановлення та Налаштування

Виконайте ці кроки, щоб розгорнути та налаштувати автоматизацію.

Крок 1: Підготовка

Перед початком налаштування, підготуйте наступне:

    Google Таблиця з даними:

        Створіть Google Форму.

        На вкладці "Відповіді" створіть пов'язану Google Таблицю.

        Відкрийте цю таблицю і скопіюйте її ID з адресного рядка. ID — це частина URL між .../d/ та /edit....

    Файл-шаблон:

        Створіть Google Slides або Google Docs документ, який буде шаблоном.

        Розставте в ньому плейсхолдери, наприклад {{Ім'я}}, {{Email}}. Назви в дужках мають точно відповідати назвам колонок у вашій Google Таблиці.

        Скопіюйте ID цього шаблону з його URL.

    Папка для збереження:

        Створіть на Google Drive папку, куди будуть зберігатися готові документи.

        Скопіюйте ID цієї папки з її URL. ID — це остання частина URL після .../folders/.

Крок 2: Встановлення коду

    Створіть нову порожню Google Таблицю, яка буде використовуватися як черга завдань. Назвіть її, наприклад, "Queue - Automation".

    У цій таблиці відкрийте редактор скриптів через меню Розширення > Apps Script.

    Для кожного .gs файлу з цього репозиторію:

        У редакторі Apps Script натисніть + > Скрипт.

        Дайте файлу точну назву (наприклад, _config.gs).

        Скопіюйте весь код з відповідного файлу на GitHub і вставте його в редактор, замінивши стандартний вміст.

    Після копіювання всіх файлів, збережіть проєкт (іконка дискети).

Крок 3: Конфігурація

    У редакторі відкрийте файл _config.gs. Налаштуйте основні параметри:

        SOURCE_SHEET_NAME: Вкажіть точну назву аркуша з відповідями у вашій таблиці-джерелі.

        TARGET_APP: Встановіть 'SLIDES' або 'DOCS', залежно від вашого шаблону.

    Відкрийте файл _setup.gs і додайте в нього цей код, якщо його там немає:
    JavaScript

    function onOpen() {
      SpreadsheetApp.getUi()
        .createMenu('⚙️ Налаштування Автоматизації')
        .addItem('Запустити початкове налаштування', 'initialSetup')
        .addToUi();
    }

    Збережіть усі зміни.

Крок 4: Запуск майстра налаштування

    Поверніться до вашої таблиці "Queue - Automation" і оновіть сторінку.

    У головному меню з'явиться новий пункт ⚙️ Налаштування Автоматизації.

    Натисніть на нього і виберіть "Запустити початкове налаштування".

    Надайте необхідні дозволи, пройшовши всі кроки авторизації.

    У спливаючих вікнах послідовно вставте ID, які ви підготували на першому кроці (ID таблиці-джерела, ID шаблону, ID папки для збереження).

Крок 5: Налаштування тригерів

Щоб автоматизація працювала сама, запустіть по черзі з редактора три функції-налаштувальники:

    Виберіть та запустіть setupProducer.

    Виберіть та запустіть setupConsumer.

    Виберіть та запустіть setupFiller.

Готово
